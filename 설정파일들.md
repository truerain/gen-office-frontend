## 초기 Settings

빌드 캐싱(Build Caching) 전략은 모노레포의 핵심 효율성 도구입니다. 한 마디로 요약하면 **"이미 했던 작업은 두 번 다시 하지 않는다"**는 원칙입니다.

gen-office처럼 프로젝트가 커지면 전체 빌드에 수십 분이 걸릴 수 있는데, 캐싱을 사용하면 수 초 내에 끝낼 수 있습니다.

1. 빌드 캐싱의 작동 원리
Turborepo는 특정 작업(예: build, test, lint)을 수행할 때 다음 네 가지 요소를 조합해 해시(Hash)값을 생성합니다.
입력값(Inputs): 해당 패키지의 소스 코드, 설정 파일 등
의존성(Dependencies): 내가 사용하는 패키지의 상태
환경 변수(Environment Variables): NODE_ENV 등
명령어(Command): tsc나 vite build 등

이 해시값이 이전과 동일하다면, Turborepo는 실제 명령을 실행하는 대신 이전에 저장해둔 결과물(Artifacts)을 그대로 복사해와서 완료된 것처럼 처리합니다.

turbo.json
```
{
  "$schema": "https://turbo.build/schema.json",
  "tasks": {
    "build": {
      "dependsOn": ["^build"], // 나를 의존하는 패키지의 빌드가 먼저 완료되어야 함
      "inputs": ["src/**", "package.json", "tsconfig.json", "*.css"], // 이 파일들이 변하면 캐시 깨짐
      "outputs": ["dist/**", ".next/**"] // 캐싱할 결과물 폴더
    },
    "lint": {
      "outputs": [] // 결과물은 없지만 성공 여부를 캐싱함 (로그 캐싱)
    },
    "dev": {
      "cache": false, // 개발 서버는 실시간 변경을 봐야 하므로 캐싱 끔
      "persistent": true
    }
  }
}
```
3. 로컬 캐싱 vs 원격 캐싱 (Remote Caching)
로컬 캐싱: 내 컴퓨터의 node_modules/.cache/turbo에 저장됩니다. 나 혼자 작업할 때만 빠릅니다.

원격 캐싱: 팀원 A가 빌드한 결과물을 클라우드에 올리면, 팀원 B는 코드를 내려받고 빌드할 때 팀원 A가 만든 결과물을 그대로 가져옵니다. (Vercel 등을 연동하여 사용)

4. gen-office 구조에서의 예시
사용자가 packages/primitive의 버튼 CSS를 수정했습니다.
pnpm build를 실행합니다.

Turborepo의 판단:
design-tokens, theme: 변경 없음 → Cache Hit (빌드 생략)
primitive: 변경됨 → Re-build (실제 빌드 수행)
apps/demo: primitive에 의존함 → Re-build (새로운 primitive를 반영하기 위해 빌드 수행)
결과적으로 변경된 부분과 그 영향권에 있는 부분만 빌드하게 됩니다.
